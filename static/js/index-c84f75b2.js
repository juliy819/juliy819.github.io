import{_ as V,b as q,c as se,a as oe,f as B,m as ae}from"./index-15414ed8.js";import{a as ie,w as ne}from"./@vueuse-4d6fb19c.js";import{l as E,r as y,b as H,n as ce,R as i,S as r,aa as e,ah as s,j as g,F as S,aO as M,aD as b,u as c,H as z,b0 as a,e as le,a9 as T,bl as d,aP as O,aQ as re,D as _e,a8 as L,aL as de,aJ as me}from"./@vue-2d0ddfb4.js";import{_ as ue}from"./index-03919f29.js";import{_ as pe}from"./Waves-e4859cde.js";import{a as F}from"./index-b5bbc619.js";import{u as ve}from"./vue-router-2a5450bb.js";import{s as he,h as ge,o as fe,j as ye,m as ke}from"./naive-ui-b87942d2.js";import"./pinia-948ba97c.js";import"./vue-demi-71ba0ef2.js";import"./pinia-plugin-persist-4bd0ee57.js";import"./nprogress-29a3b628.js";import"./@babel-061b4810.js";import"./js-cookie-cf83ad76.js";import"./axios-aba6f0e0.js";import"./dayjs-aaaa0bae.js";import"./swiper-d1934b6f.js";import"./ssr-window-c9202916.js";import"./@kangc-6220f0f5.js";import"./vue-a1bd1397.js";import"./markdown-it-emoji-4f1b57fa.js";import"./prismjs-08ac3f6b.js";import"./v-viewer-8afc779e.js";import"./viewerjs-3fd8af48.js";import"./vueuc-27e3b830.js";import"./evtd-b614532e.js";import"./seemly-76b7b838.js";import"./@css-render-c34b42f4.js";import"./vooks-d838407f.js";import"./vdirs-b0483831.js";import"./@juggle-41516555.js";import"./css-render-d3958e6a.js";import"./@emotion-8a8e73f6.js";import"./lodash-es-0dc9900e.js";import"./treemate-25c27bff.js";import"./async-validator-dee29e8b.js";import"./date-fns-975a2d8f.js";import"./index-9bfe1da5.js";const xe={class:"catalog-header"},Ce={class:"catalog-content"},Te=["onClick"],we=E({__name:"Catalog",props:{domRef:{type:Object,default:null}},setup(k){const v=k,{y:C}=ie(window),x=y([]),f=y(0),w=()=>{const u=v.domRef.$el.querySelectorAll("h1,h2,h3"),n=Array.from(u).filter(l=>!!l.innerText.trim());n.length||(x.value=[]);const p=Array.from(new Set(n.map(l=>l.tagName))).sort();x.value=n.map(l=>({title:l.innerText,lineIndex:l.getAttribute("data-v-md-line"),indent:p.indexOf(l.tagName)}))},h=u=>{const n=v.domRef.$el.querySelector(`[data-v-md-line="${u.lineIndex}"]`);n&&window.scrollTo({behavior:"smooth",top:n.offsetTop-20})};return H(()=>{ce(()=>{setTimeout(w,500)})}),ne(C,()=>{x.value.forEach((u,n)=>{const p=v.domRef.$el.querySelector(`[data-v-md-line="${u.lineIndex}"]`);C.value>=p.offsetTop-30&&(f.value=n)})},{throttle:100}),(u,n)=>{const p=V;return i(),r(S,null,[e("div",xe,[s(p,{"icon-class":"category"}),g(" 目录 ")]),e("div",Ce,[(i(!0),r(S,null,M(c(x),(l,t)=>(i(),r("div",{class:b(["catalog-item",c(f)===t?"active":""]),key:t,style:z({paddingLeft:`${5+l.indent*15}px`}),onClick:I=>h(l)},[e("a",null,a(l.title),1)],14,Te))),128))])],64)}}});const Ae=q(we,[["__scopeId","data-v-8de4d6b7"]]),m=k=>(de("data-v-310eaa05"),k=k(),me(),k),be={class:"page-header"},Se={class:"page-title"},$e={class:"article-title"},Ne={key:0,class:"article-time"},Le={class:"first-meta"},ze={class:"meta-item"},Ie={class:"text"},Re={key:0,class:"meta-item"},De={class:"text"},je={key:1,class:"meta-item"},Be={class:"text"},Oe={class:"second-meta"},Fe={class:"meta-item"},Ve={class:"text"},qe={class:"meta-item"},Ee={class:"text"},He={class:"meta-item"},Me=["src"],We={class:"bg"},Je={class:"main-container"},Pe={class:"article-container"},Qe={class:"tag-container"},Ye={key:0,class:"article-footer"},Ge={class:"meta"},Ke={key:0,class:"like"},Ue=m(()=>e("p",null,"觉得本篇文章还不错的话，就点个赞叭(●'◡'●)",-1)),Xe={class:"copyright"},Ze={class:"author"},et=m(()=>e("strong",null,"本文作者： ",-1)),tt={class:"link"},st=m(()=>e("strong",null,"本文链接：",-1)),ot=["href"],at={class:"license"},it=m(()=>e("strong",null,"版权声明： ",-1)),nt=m(()=>e("a",{class:"underline-a",href:"https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh",target:"_blank"}," BY-NC-SA ",-1)),ct={class:"article-nav"},lt={class:"nav-item"},rt=m(()=>e("span",{class:"nav-action"},"上一篇",-1)),_t={class:"nav-title"},dt={key:1,class:"nav-cover"},mt=m(()=>e("span",{class:"nav-action"},"上一篇",-1)),ut=m(()=>e("h3",{class:"nav-title"},"没有了",-1)),pt=[mt,ut],vt={class:"nav-item"},ht=m(()=>e("span",{class:"nav-action"},"下一篇",-1)),gt={class:"nav-title"},ft={key:1,class:"nav-cover"},yt=m(()=>e("span",{class:"nav-action"},"下一篇",-1)),kt=m(()=>e("h3",{class:"nav-title"},"没有了",-1)),xt=[yt,kt],Ct={class:"side-card"},Tt=E({__name:"index",setup(k){const v=y(0),C=window.location.href,x=ve(),{userStore:f,blogStore:w,appStore:h}=se(),u=y(),n=y(0),p=y(0),l=1,t=y({id:0,articleCover:"",articleTitle:"",articleContent:"",articleType:0,viewCount:0,likeCount:0,category:{},tagList:[],createTime:"",lastArticle:{},nextArticle:{},updateTime:""}),I=le(()=>o=>f.articleLikeSet.indexOf(o)===-1?"":"active"),$=o=>o===""?w.siteConfig.articleCover:o,W=o=>o>=1e3?(o/1e3).toFixed(1)+"k":o,J=o=>o.replace(/<\/?[^>]*>/g,"").replace(/[|]*\n/,"").replace(/&npsp;/gi,""),P=()=>{if(!f.id){ae.msgError("请先登录！");return}let o=t.value.id;F.likeArticle(o).then(()=>{f.articleLikeSet.indexOf(o)!==-1?t.value.likeCount-=1:t.value.likeCount+=1,f.articleLike(o)}).catch(()=>{})};return H(()=>{F.getArticle(Number(x.params.id)).then(({data:o})=>{t.value=o.data,document.title=t.value.articleTitle,n.value=J(t.value.articleContent).length,p.value=Math.round(n.value/400),v.value=1}).catch(()=>{v.value=-1,t.value.createTime="2023-1-1",t.value.articleTitle="文章",t.value.category={id:0,categoryName:"分类"},n.value=0,p.value=0})}),(o,R)=>{const _=V,Q=pe,Y=O("v-md-preview"),G=he,N=O("router-link"),K=ge,U=ue,X=Ae,D=fe,j=ye,Z=ke,ee=oe,te=re("viewer");return i(),r(S,null,[e("div",be,[e("div",Se,[e("h1",$e,a(t.value.articleTitle),1),v.value===1?(i(),r("div",Ne,[e("div",Le,[e("span",ze,[s(_,{"icon-class":"calendar",style:{"margin-right":"0.15rem"}}),e("span",Ie,"发表于 "+a(c(B)(t.value.createTime)),1)]),t.value.updateTime&&!c(h).local?(i(),r("span",Re,[s(_,{"icon-class":"update",style:{"margin-right":"0.15rem"}}),e("span",De,"更新于 "+a(c(B)(t.value.updateTime)),1)])):T("",!0),c(h).local?T("",!0):(i(),r("span",je,[s(_,{"icon-class":"eye",style:{"margin-right":"0.15rem"}}),e("span",Be,"阅读量 "+a(t.value.viewCount),1)]))]),e("div",Oe,[e("span",Fe,[s(_,{"icon-class":"edit",style:{"margin-right":"0.15rem"}}),e("span",Ve,"字数统计： "+a(W(n.value))+"字",1)]),e("span",qe,[s(_,{"icon-class":"clock",style:{"margin-right":"0.15rem"}}),e("span",Ee,"预计阅读时长： "+a(p.value)+" 分钟",1)]),e("span",He,[s(_,{"icon-class":"category",style:{"margin-right":"0.15rem"}}),g(" "+a(t.value.category.categoryName),1)])])])):T("",!0)]),e("img",{class:"page-cover",src:$(t.value.articleCover),alt:""},null,8,Me),s(Q)]),e("div",We,[s(ee,{status:v.value},{data:d(()=>[e("div",Je,[e("div",{class:b(["left-container",c(h).rightContainer?"":"width-100"])},[e("div",Pe,[_e(s(Y,{ref_key:"articleRef",ref:u,class:"md",text:t.value.articleContent},null,8,["text"]),[[te]]),e("div",Qe,[(i(!0),r(S,null,M(t.value.tagList,A=>(i(),L(N,{to:`/tag/${A.id}`,class:"article-tag-category",key:A.id},{default:d(()=>[s(G,{style:{"max-width":"8rem"}},{default:d(()=>[s(_,{"icon-class":"tag",size:"0.8rem"}),g(" "+a(A.tagName),1)]),_:2},1024)]),_:2},1032,["to"]))),128))]),c(h).local?T("",!0):(i(),r("footer",Ye,[e("div",Ge," 阅读次数 "+a(t.value.viewCount)+" 次 ",1),c(h).local?T("",!0):(i(),r("div",Ke,[s(K,{class:b(["like-btn",c(I)(t.value.id)]),onClick:R[0]||(R[0]=A=>P())},{default:d(()=>[s(_,{"icon-class":"like",size:"0.9rem",style:{"margin-right":"0.5rem"}}),g(" 点赞 "+a(t.value.likeCount),1)]),_:1},8,["class"]),Ue])),e("div",Xe,[e("ul",null,[e("li",Ze,[s(_,{"icon-class":"author",size:"0.9rem",style:{"margin-right":"0.3rem"}}),et,g(a(c(w).siteConfig.siteAuthor),1)]),e("li",tt,[s(_,{"icon-class":"article_link",size:"0.9rem",style:{"margin-right":"0.3rem"}}),st,e("a",{class:"underline-a",href:c(C)},a(c(C)),9,ot)]),e("li",at,[s(_,{"icon-class":"article_share",size:"0.8rem",style:{"margin-right":"0.3rem"}}),it,g(" 本站所有文章除特别声明外，均采用 "),nt,g(" 许可协议。转载请注明文章出处！ ")])])])])),e("div",ct,[e("div",lt,[t.value.lastArticle?(i(),L(N,{key:0,to:`/article/${t.value.lastArticle.id}`,class:"nav-cover",style:z({"background-image":"url("+$(t.value.lastArticle.articleCover)+")"})},{default:d(()=>[rt,e("h3",_t,a(t.value.lastArticle.articleTitle),1)]),_:1},8,["to","style"])):(i(),r("div",dt,pt))]),e("div",vt,[t.value.nextArticle?(i(),L(N,{key:0,to:`/article/${t.value.nextArticle.id}`,class:"nav-cover",style:z({"background-image":"url("+$(t.value.nextArticle.articleCover)+")"})},{default:d(()=>[ht,e("h3",gt,a(t.value.nextArticle.articleTitle),1)]),_:1},8,["to","style"])):(i(),r("div",ft,xt))])]),s(U,{"comment-type":l})])],2),e("div",{class:b(["right-container",c(h).rightContainer?"":"display-none"])},[e("div",Ct,[s(X,{"dom-ref":u.value},null,8,["dom-ref"])])],2)])]),loading:d(()=>[s(j,{justify:"start",vertical:"",style:{margin:"1rem"}},{default:d(()=>[s(D,{round:"",size:"large",width:"40%"}),s(D,{text:"",round:"",width:"100%",repeat:10})]),_:1})]),fail:d(()=>[s(j,{justify:"center",align:"center",style:{height:"30vh"}},{default:d(()=>[s(Z,{type:"error",size:"30",style:{"font-weight":"bold"}},{default:d(()=>[g(" 文章加载失败 ")]),_:1})]),_:1})]),_:1},8,["status"])])],64)}}});const ls=q(Tt,[["__scopeId","data-v-310eaa05"]]);export{ls as default};

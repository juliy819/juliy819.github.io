import{_ as A}from"./Waves-e4859cde.js";import{c as y,i as U,g as V,m as x,b as T}from"./index-15414ed8.js";import{V as E}from"./vue-cropper-e9236157.js";import{l as H,h as B,z as W,k as j,i as D,j as L,f as N,g as z,r as q}from"./naive-ui-b87942d2.js";import{l as $,r as w,f as J,R as h,S as I,ah as t,u as e,bl as a,j as c,aa as p,c as M,b as G,F as K,aL as O,aJ as P,a8 as S}from"./@vue-2d0ddfb4.js";import{a as Q}from"./vue-router-2a5450bb.js";import"./pinia-948ba97c.js";import"./vue-demi-71ba0ef2.js";import"./pinia-plugin-persist-4bd0ee57.js";import"./nprogress-29a3b628.js";import"./@babel-061b4810.js";import"./@vueuse-4d6fb19c.js";import"./js-cookie-cf83ad76.js";import"./axios-aba6f0e0.js";import"./dayjs-aaaa0bae.js";import"./swiper-d1934b6f.js";import"./ssr-window-c9202916.js";import"./@kangc-6220f0f5.js";import"./vue-a1bd1397.js";import"./markdown-it-emoji-4f1b57fa.js";import"./prismjs-08ac3f6b.js";import"./v-viewer-8afc779e.js";import"./viewerjs-3fd8af48.js";import"./vueuc-27e3b830.js";import"./evtd-b614532e.js";import"./seemly-76b7b838.js";import"./@css-render-c34b42f4.js";import"./vooks-d838407f.js";import"./vdirs-b0483831.js";import"./@juggle-41516555.js";import"./css-render-d3958e6a.js";import"./@emotion-8a8e73f6.js";import"./lodash-es-0dc9900e.js";import"./treemate-25c27bff.js";import"./async-validator-dee29e8b.js";import"./date-fns-975a2d8f.js";const X={style:{width:"100%",height:"300px"}},Y=$({__name:"UserAvatar",setup(d){const{userStore:m}=y(),n=w(!1),f=w(),l=J({img:m.avatar,autoCrop:!0,autoCropWidth:200,autoCropHeight:200,fixedBox:!0,outputType:"png"}),r=({file:o})=>{const s=new FileReader;s.readAsDataURL(o.file),s.onload=()=>{l.img=s.result}},b=()=>{l.img=m.avatar},k=()=>{f.value.getCropBlob(o=>{let s=new FormData;s.append("file",o),U.updateAvatar(s).then(({data:u})=>{l.img=u.data,m.avatar=l.img,n.value=!1}).catch(()=>{})})};return(o,s)=>{const u=H,_=B,g=W,C=j;return h(),I("div",null,[t(u,{size:150,circle:"",src:e(m).avatar,onClick:s[0]||(s[0]=v=>n.value=!0)},null,8,["src"]),t(C,{class:"bg",show:e(n),"onUpdate:show":s[2]||(s[2]=v=>M(n)?n.value=v:null),preset:"dialog","show-icon":!1,"transform-origin":"center","block-scroll":!1,closable:!1,onAfterLeave:b},{action:a(()=>[t(_,{color:"#3e999f",onClick:s[1]||(s[1]=v=>n.value=!1)},{default:a(()=>[c(" 取消 ")]),_:1}),t(_,{color:"#e9546b",onClick:k},{default:a(()=>[c(" 提交 ")]),_:1})]),default:a(()=>[p("div",X,[t(e(E),{ref_key:"cropperRef",ref:f,img:e(l).img,info:!0,autoCrop:e(l).autoCrop,autoCropWidth:e(l).autoCropWidth,autoCropHeight:e(l).autoCropHeight,fixedBox:e(l).fixedBox,outputType:e(l).outputType},null,8,["img","autoCrop","autoCropWidth","autoCropHeight","fixedBox","outputType"])]),t(g,{class:"mt30",action:"#",accept:"image/*","show-file-list":!1,"custom-request":r},{default:a(()=>[t(_,null,{default:a(()=>[c("点击上传")]),_:1})]),_:1})]),_:1},8,["show"])])}}}),R=d=>(O("data-v-dd01e7b3"),d=d(),P(),d),Z={class:"page-header"},ee=R(()=>p("h1",{class:"page-title"},"个人中心",-1)),te=["src"],oe={class:"bg"},ae={class:"page-container"},ne=R(()=>p("div",{class:"title"},"基本信息",-1)),se={class:"info-container"},le={class:"info mt30"},re=$({__name:"index",setup(d){const m=V(),{userStore:n,appStore:f}=y(),l=Q(),r=w({nickname:n.nickname,intro:n.intro,webSite:n.webSite}),b=()=>{U.updateUserInfo(r.value).then(()=>{n.updateUserInfo(r.value),x.msgSuccess("修改成功")}).catch(()=>{})};return G(()=>{n.id||l.push("/").then(()=>{x.msgError("请先登录")})}),(k,o)=>{const s=A,u=N,_=z,g=B,C=q,v=D,F=L;return h(),I(K,null,[p("div",Z,[ee,p("img",{class:"page-cover",src:e(m),alt:""},null,8,te),t(s)]),p("div",oe,[p("div",ae,[ne,p("div",se,[t(Y,{class:"avatar"}),p("div",le,[t(v,{"label-align":"left","label-width":80,model:e(r)},{default:a(()=>[t(_,{label:"昵称",path:"nickname"},{default:a(()=>[t(u,{placeholder:"输入您的昵称",value:e(r).nickname,"onUpdate:value":o[0]||(o[0]=i=>e(r).nickname=i),clearable:""},null,8,["value"])]),_:1}),t(_,{label:"个人网站",path:"website"},{default:a(()=>[t(u,{placeholder:"没有的话就空着叭",value:e(r).webSite,"onUpdate:value":o[1]||(o[1]=i=>e(r).webSite=i),clearable:""},null,8,["value"])]),_:1}),t(_,{label:"简介",path:"intro"},{default:a(()=>[t(u,{placeholder:"介绍一下自己吧",value:e(r).intro,"onUpdate:value":o[2]||(o[2]=i=>e(r).intro=i),clearable:""},null,8,["value"])]),_:1}),t(_,{label:"邮箱",path:"email"},{default:a(()=>[t(C,null,{default:a(()=>[t(u,{placeholder:"请输入邮箱",disabled:"",value:e(n).email,"onUpdate:value":o[3]||(o[3]=i=>e(n).email=i)},null,8,["value"]),e(n).email?(h(),S(g,{key:0,onClick:o[4]||(o[4]=i=>e(f).showEmailFrame())},{default:a(()=>[c(" 修改邮箱 ")]),_:1})):(h(),S(g,{key:1,onClick:o[5]||(o[5]=i=>e(f).showEmailFrame())},{default:a(()=>[c(" 绑定邮箱 ")]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"]),t(F,{justify:"center"},{default:a(()=>[t(g,{style:{width:"5rem"},round:"",onClick:b},{default:a(()=>[c("修改")]),_:1})]),_:1})])])])])],64)}}});const Je=T(re,[["__scopeId","data-v-dd01e7b3"]]);export{Je as default};
